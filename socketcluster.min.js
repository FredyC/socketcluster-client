!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.socketCluster=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&";eq=eq||"=";var obj={};if(typeof qs!=="string"||qs.length===0){return obj}var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;if(options&&typeof options.maxKeys==="number"){maxKeys=options.maxKeys}var len=qs.length;if(maxKeys>0&&len>maxKeys){len=maxKeys}for(var i=0;i<len;++i){var x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq),kstr,vstr,k,v;if(idx>=0){kstr=x.substr(0,idx);vstr=x.substr(idx+1)}else{kstr=x;vstr=""}k=decodeURIComponent(kstr);v=decodeURIComponent(vstr);if(!hasOwnProperty(obj,k)){obj[k]=v}else if(isArray(obj[k])){obj[k].push(v)}else{obj[k]=[obj[k],v]}}return obj};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"}},{}],2:[function(require,module,exports){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){sep=sep||"&";eq=eq||"=";if(obj===null){obj=undefined}if(typeof obj==="object"){return map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;if(isArray(obj[k])){return map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep)}else{return ks+encodeURIComponent(stringifyPrimitive(obj[k]))}}).join(sep)}if(!name)return"";return encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj))};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"};function map(xs,f){if(xs.map)return xs.map(f);var res=[];for(var i=0;i<xs.length;i++){res.push(f(xs[i],i))}return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))res.push(key)}return res}},{}],3:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode");exports.encode=exports.stringify=require("./encode")},{"./decode":1,"./encode":2}],4:[function(require,module,exports){var SCSocket=require("./lib/scsocket");module.exports.SCSocket=SCSocket;module.exports.Emitter=require("emitter");module.exports.connect=function(options){return new SCSocket(options)}},{"./lib/scsocket":9,emitter:10}],5:[function(require,module,exports){var Emitter=require("emitter");if(!Object.create){Object.create=require("./objectcreate")}var ActivityManager=function(){var self=this;this._interval=null;this._intervalDuration=1e3;this._counter=null;if(window.addEventListener){window.addEventListener("blur",function(){self._triggerBlur()});window.addEventListener("focus",function(){self._triggerFocus()})}else if(window.attachEvent){window.attachEvent("onblur",function(){self._triggerBlur()});window.attachEvent("onfocus",function(){self._triggerFocus()})}else{throw new Error("The browser does not support proper event handling")}};ActivityManager.prototype=Object.create(Emitter.prototype);ActivityManager.prototype._triggerBlur=function(){var self=this;var now=(new Date).getTime();this._counter=now;this._interval=setInterval(function(){var newCount=(new Date).getTime();if(newCount-self._counter<self._intervalDuration*3){self._counter=newCount}},this._intervalDuration);this.emit("deactivate")};ActivityManager.prototype._triggerFocus=function(){clearInterval(this._interval);var now=(new Date).getTime();if(this._counter!=null&&now-this._counter>=this._intervalDuration*3){this.emit("wakeup")}this.emit("activate")};module.exports.ActivityManager=ActivityManager},{"./objectcreate":6,emitter:10}],6:[function(require,module,exports){module.exports.create=function(){function F(){}return function(o){if(arguments.length!=1){throw new Error("Object.create implementation only accepts one parameter.")}F.prototype=o;return new F}}()},{}],7:[function(require,module,exports){var Response=function(socket,id){this.socket=socket;this.id=id};Response.prototype._respond=function(responseData){this.socket.send(this.socket.stringify(responseData))};Response.prototype.end=function(data){if(this.id){var responseData={cid:this.id};if(data!==undefined){responseData.data=data}this._respond(responseData)}};Response.prototype.error=function(error,data){if(this.id){var err;if(error instanceof Error){err={name:error.name,message:error.message,stack:error.stack}}else{err=error}var responseData={cid:this.id,error:err};if(data!==undefined){responseData.data=data}this._respond(responseData)}};Response.prototype.callback=function(error,data){if(error){this.error(error,data)}else{this.end(data)}};module.exports.Response=Response},{}],8:[function(require,module,exports){var Emitter=require("emitter");if(!Object.create){Object.create=require("./objectcreate")}var SCChannel=function(name,socket){var self=this;Emitter.call(this);this.SUBSCRIBED="subscribed";this.PENDING="pending";this.UNSUBSCRIBED="unsubscribed";this.name=name;this.state=this.UNSUBSCRIBED;this.socket=socket};SCChannel.prototype=Object.create(Emitter.prototype);SCChannel.prototype.getState=function(){return this.state};SCChannel.prototype.subscribe=function(){this.socket.subscribe(this.name)};SCChannel.prototype.unsubscribe=function(){this.socket.unsubscribe(this.name)};SCChannel.prototype.isSubscribed=function(includePending){return this.socket.isSubscribed(this.name,includePending)};SCChannel.prototype.publish=function(data,callback){this.socket.publish(this.name,data,callback)};SCChannel.prototype.watch=function(handler){this.socket.watch(this.name,handler)};SCChannel.prototype.unwatch=function(handler){this.socket.unwatch(this.name,handler)};SCChannel.prototype.destroy=function(){this.socket.destroyChannel(this.name)};module.exports=SCChannel},{"./objectcreate":6,emitter:10}],9:[function(require,module,exports){(function(global){var WebSocket=require("ws");var Emitter=require("emitter");var SCChannel=require("./scchannel");var Response=require("./response").Response;var ActivityManager=require("./activitymanager").ActivityManager;var querystring=require("querystring");if(!Object.create){Object.create=require("./objectcreate")}var isBrowser=typeof window!="undefined";if(isBrowser){var activityManager=new ActivityManager}var SCSocket=function(options){var self=this;Emitter.call(this);var opts={port:null,autoReconnect:true,ackTimeout:1e4,hostname:global.location&&location.hostname,path:"/socketcluster/",secure:global.location&&location.protocol=="https:",timestampRequests:false,timestampParam:"t",binaryType:"arraybuffer"};for(var i in options){opts[i]=options[i]}this.id=null;this._localEvents={open:1,close:1,connect:1,disconnect:1,error:1,raw:1,fail:1,kickOut:1,setAuthToken:1,removeAuthToken:1,ready:1};this._persistentEvents={subscribe:1,unsubscribe:1};this._connectAttempts=0;this._cid=1;this._isActive=false;this._callbackMap={};this._destId=null;this._emitBuffer=[];this._channels={};this._enableAutoReconnect=true;this._base64Chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";this._tokenData=null;this.options=opts;if(this.options.autoReconnect&&this.options.autoReconnectOptions==null){this.options.autoReconnectOptions={delay:1e4,randomness:1e4}}this.options.path=this.options.path.replace(/\/$/,"")+"/";this.options.query=opts.query||{};if(typeof this.options.query=="string"){this.options.query=querystring.parse(this.options.query)}this.options.port=opts.port||(global.location&&location.port?location.port:this.options.secure?443:80);this.connect();this._channelEmitter=new Emitter;if(isBrowser){activityManager.on("wakeup",function(){self.close();self.connect()})}};SCSocket.prototype=Object.create(Emitter.prototype);SCSocket.CONNECTING=SCSocket.prototype.CONNECTING=WebSocket.prototype.CONNECTING;SCSocket.OPEN=SCSocket.prototype.OPEN=WebSocket.prototype.OPEN;SCSocket.CLOSING=SCSocket.prototype.CLOSING=WebSocket.prototype.CLOSING;SCSocket.CLOSED=SCSocket.prototype.CLOSED=WebSocket.prototype.CLOSED;SCSocket.ignoreStatuses={1e3:"Socket closed normally",1001:"Socket hung up"};SCSocket.errorStatuses={1001:"Socket was disconnected",1002:"A WebSocket protocol error was encountered",1003:"Server terminated socket because it received invalid data",1006:"Socket connection failed",1007:"Message format was incorrect",1008:"Encountered a policy violation",1009:"Message was too big to process",1010:"Client ended the connection because the server did not comply with extension requirements",1011:"Server encountered an unexpected fatal condition"};SCSocket.prototype.uri=function(){var query=this.options.query||{};var schema=this.options.secure?"wss":"ws";var port="";if(this.options.port&&("wss"==schema&&this.options.port!=443||"ws"==schema&&this.options.port!=80)){port=":"+this.options.port}if(this.options.timestampRequests){query[this.options.timestampParam]=(new Date).getTime()}query=querystring.stringify(query);if(query.length){query="?"+query}return schema+"://"+this.options.hostname+port+this.options.path+query};SCSocket.prototype.getState=function(){if(!this.socket){return this.CLOSED}return this.socket.readyState};SCSocket.prototype.getBytesReceived=function(){return this.socket.bytesReceived};SCSocket.prototype.connect=SCSocket.prototype.open=function(){var self=this;var readyState=this.getState();if(readyState==this.CLOSED||readyState==this.CLOSING){var uri=this.uri();this.socket=new WebSocket(uri,null,this.options);this._isActive=false;this.socket.binaryType=this.options.binaryType;this.socket.onopen=function(){self._onSCOpen()};this.socket.onclose=function(event){self._onSCClose(event)};this.socket.onmessage=function(message,flags){self._onSCMessage(message.data)};this._resubscribe()}};SCSocket.prototype.disconnect=function(code,data){code=code||1e3;this._enableAutoReconnect=false;this.socket.close(code,data)};SCSocket.prototype.terminate=function(){this._enableAutoReconnect=false;this.socket.terminate()};SCSocket.prototype._onSCOpen=function(){this._connectAttempts=0;this._enableAutoReconnect=true;this._isActive=true;Emitter.prototype.emit.call(this,"connect");this._flushEmitBuffer()};SCSocket.prototype._tryReconnect=function(){var self=this;var readyState=this.getState();if((readyState==this.CLOSED||readyState==this.CLOSING)&&this.options.autoReconnect&&this._enableAutoReconnect){this._emitBuffer=[];var reconnectOptions=this.options.autoReconnectOptions;var exponent=this._connectAttempts++;if(exponent>5){exponent=5}var initialTimeout=Math.round(reconnectOptions.delay+(reconnectOptions.randomness||0)*Math.random());var timeout=Math.round(initialTimeout*Math.pow(1.5,exponent));clearTimeout(this._reconnectTimeout);this._reconnectTimeout=setTimeout(function(){if(readyState==self.CLOSED||readyState==self.CLOSING){self.connect()}},timeout)}};SCSocket.prototype._onSCError=function(err){if(this.listeners("error").length<1){setTimeout(function(){throw err},0)}else{Emitter.prototype.emit.call(this,"error",err)}};SCSocket.prototype._onSCClose=function(event){this.id=null;var channel,newState;for(var channelName in this._channels){channel=this._channels[channelName];if(channel.state==channel.SUBSCRIBED||channel.state==channel.PENDING){newState=channel.PENDING}else{newState=channel.UNSUBSCRIBED}this._triggerChannelUnsubscribe(channel,newState)}if(this._isActive){this._isActive=false;Emitter.prototype.emit.call(this,"disconnect",event)}if(!SCSocket.ignoreStatuses[event.code]){var err=new Error(SCSocket.errorStatuses[event.code]||"Socket connection failed for unknown reasons");err.code=event.code;this._onSCError(err)}delete this.socket.onopen;delete this.socket.onclose;delete this.socket.onmessage;this._tryReconnect()};SCSocket.prototype._setCookie=function(name,value,expirySeconds){var exdate=null;if(expirySeconds){exdate=new Date;exdate.setTime(exdate.getTime()+Math.round(expirySeconds*1e3))}var value=escape(value)+"; path=/;"+(exdate==null?"":" expires="+exdate.toUTCString()+";");document.cookie=name+"="+value};SCSocket.prototype._getCookie=function(name){var i,x,y,ARRcookies=document.cookie.split(";");for(i=0;i<ARRcookies.length;i++){x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);x=x.replace(/^\s+|\s+$/g,"");if(x==name){return unescape(y)}}};SCSocket.prototype._onSCMessage=function(message){Emitter.prototype.emit.call(this,"message",message);var e;try{e=this.parse(message)}catch(err){e=message}if(e.event){if(e.event=="fail"){this._onSCError(e.data)}else if(e.event=="kickOut"){var kickData=e.data||{};var channelName=kickData.channel;var channel=this._channels[channelName];if(channel){Emitter.prototype.emit.call(this,e.event,kickData.message,channelName);channel.emit(e.event,kickData.message,channelName);this._triggerChannelUnsubscribe(channel)}}else if(e.event=="setAuthToken"){var tokenData=e.data;var response=new Response(this,e.cid);if(tokenData){this._tokenData=tokenData;if(tokenData.persistent&&tokenData.expiresInMinutes!=null){this._setCookie(tokenData.cookieName,tokenData.token,tokenData.expiresInMinutes*60)}else{this._setCookie(tokenData.cookieName,tokenData.token)}Emitter.prototype.emit.call(this,e.event,tokenData.token);response.end()}else{response.error("No token data provided with setAuthToken event")}}else if(e.event=="removeAuthToken"){if(this._tokenData){this._setCookie(this._tokenData.cookieName,null,-1);Emitter.prototype.emit.call(this,e.event)}var response=new Response(this,e.cid);response.end()}else if(e.event=="ready"){if(e.data){this.id=e.data.id}Emitter.prototype.emit.call(this,e.event,e.data)}else{var response=new Response(this,e.cid);Emitter.prototype.emit.call(this,e.event,e.data,function(error,data){response.callback(error,data)})}}else if(e.channel){this._channelEmitter.emit(e.channel,e.data)}else if(e.cid==null){Emitter.prototype.emit.call(this,"raw",e)}else{var ret=this._callbackMap[e.cid];if(ret){clearTimeout(ret.timeout);delete this._callbackMap[e.cid];ret.callback(e.error,e.data)}if(e.error){this._onSCError(e.error)}}};SCSocket.prototype._nextCallId=function(){return this._cid++};SCSocket.prototype._isOwnDescendant=function(object,ancestors){for(var i in ancestors){if(ancestors[i]===object){return true}}return false};SCSocket.prototype._arrayBufferToBase64=function(arraybuffer){var chars=this._base64Chars;var bytes=new Uint8Array(arraybuffer);var len=bytes.length;var base64="";for(var i=0;i<len;i+=3){base64+=chars[bytes[i]>>2];base64+=chars[(bytes[i]&3)<<4|bytes[i+1]>>4];base64+=chars[(bytes[i+1]&15)<<2|bytes[i+2]>>6];base64+=chars[bytes[i+2]&63]}if(len%3===2){base64=base64.substring(0,base64.length-1)+"="}else if(len%3===1){base64=base64.substring(0,base64.length-2)+"=="}return base64};SCSocket.prototype._convertBuffersToBase64=function(object,ancestors){if(!ancestors){ancestors=[]}if(this._isOwnDescendant(object,ancestors)){throw new Error("Cannot traverse circular structure")}var newAncestors=ancestors.concat([object]);if(typeof ArrayBuffer!="undefined"&&object instanceof ArrayBuffer){return{base64:true,data:this._arrayBufferToBase64(object)}}if(object instanceof Array){var base64Array=[];for(var i in object){base64Array[i]=this._convertBuffersToBase64(object[i],newAncestors)}return base64Array}if(object instanceof Object){var base64Object={};for(var j in object){base64Object[j]=this._convertBuffersToBase64(object[j],newAncestors)}return base64Object}return object};SCSocket.prototype.parse=function(message){return JSON.parse(message)};SCSocket.prototype.stringify=function(object){return JSON.stringify(this._convertBuffersToBase64(object))};SCSocket.prototype.send=function(data,options,callback){var self=this;this.socket.send(data,options,function(err){callback&&callback(err);if(err){self._onSCError(err)}})};SCSocket.prototype._emit=function(eventObject){eventObject.cid=this._nextCallId();if(eventObject.callback){this._callbackMap[eventObject.cid]=eventObject}var simpleEventObject={event:eventObject.event,data:eventObject.data,cid:eventObject.cid};this.send(this.stringify(simpleEventObject))};SCSocket.prototype._flushEmitBuffer=function(){var len=this._emitBuffer.length;for(var i=0;i<len;i++){this._emit(this._emitBuffer[i])}this._emitBuffer=[]};SCSocket.prototype.emit=function(event,data,callback){var self=this;var readyState=this.getState();if(this._localEvents[event]==null){if(readyState==this.CLOSED||readyState==this.CLOSING){this.connect()}var eventObject={event:event,data:data,callback:callback};if(!this._persistentEvents[event]&&callback){eventObject.timeout=setTimeout(function(){var error=new Error("Event response for '"+event+"' timed out",eventObject);if(eventObject.cid){delete self._callbackMap[eventObject.cid]}delete eventObject.callback;callback(error,eventObject);self._onSCError(error)},this.options.ackTimeout)}this._emitBuffer.push(eventObject);if(readyState==this.OPEN){this._flushEmitBuffer()}}else{Emitter.prototype.emit.call(this,event,data)}};SCSocket.prototype.publish=function(channelName,data,callback){var self=this;var pubData={channel:channelName,data:data};this.emit("publish",pubData,function(err){callback&&callback(err)})};SCSocket.prototype.subscribe=function(channelName){var self=this;var channel=this._channels[channelName];if(!channel){channel=new SCChannel(channelName,this);this._channels[channelName]=channel}if(channel.state==channel.UNSUBSCRIBED){channel.state=channel.PENDING;this.emit("subscribe",channelName,function(err){if(err){self._triggerChannelSubscribeFail(err,channel)}else{self._triggerChannelSubscribe(channel)}})}return channel};SCSocket.prototype.unsubscribe=function(channelName){var channel=this._channels[channelName];if(channel){if(channel.state!=channel.UNSUBSCRIBED){this._triggerChannelUnsubscribe(channel);this.emit("unsubscribe",channelName)}}};SCSocket.prototype.channel=function(channelName){var currentChannel=this._channels[channelName];if(!currentChannel){currentChannel=new SCChannel(channelName,this);this._channels[channelName]=currentChannel}return currentChannel};SCSocket.prototype.destroyChannel=function(channelName){var channel=this._channels[channelName];channel.unwatch();channel.unsubscribe();delete this._channels[channelName]};SCSocket.prototype.subscriptions=function(includePending){var subs=[];var channel,includeChannel;for(var channelName in this._channels){channel=this._channels[channelName];if(includePending){includeChannel=channel&&(channel.state==channel.SUBSCRIBED||channel.state==channel.PENDING)}else{includeChannel=channel&&channel.state==channel.SUBSCRIBED}if(includeChannel){subs.push(channelName)}}return subs};SCSocket.prototype.isSubscribed=function(channel,includePending){var channel=this._channels[channel];if(includePending){return!!channel&&(channel.state==channel.SUBSCRIBED||channel.state==channel.PENDING)}return!!channel&&channel.state==channel.SUBSCRIBED};SCSocket.prototype._triggerChannelSubscribe=function(channel){var channelName=channel.name;channel.state=channel.SUBSCRIBED;channel.emit("subscribe",channelName);Emitter.prototype.emit.call(this,"subscribe",channelName)};SCSocket.prototype._triggerChannelSubscribeFail=function(err,channel){var channelName=channel.name;channel.state=channel.UNSUBSCRIBED;channel.emit("subscribeFail",err,channelName);Emitter.prototype.emit.call(this,"subscribeFail",err,channelName)};SCSocket.prototype._triggerChannelUnsubscribe=function(channel,newState){var channelName=channel.name;var oldState=channel.state;if(newState){channel.state=newState}else{channel.state=channel.UNSUBSCRIBED}if(oldState==channel.SUBSCRIBED){channel.emit("unsubscribe",channelName);Emitter.prototype.emit.call(this,"unsubscribe",channelName)}};SCSocket.prototype._resubscribe=function(callback){var self=this;var channels=[];for(var channelName in this._channels){channels.push(channelName)}var error;var ackCount=0;var ackHandler=function(err,channel){ackCount++;if(err){self._triggerChannelSubscribeFail(err,channel)}else{self._triggerChannelSubscribe(channel)}if(!error){if(err){error=err;callback&&callback(err)}else if(ackCount>=channels.length){callback&&callback()}}};for(var i in this._channels){(function(channel){if(channel.state==channel.PENDING){self.emit("subscribe",channel.name,function(err){ackHandler(err,channel)})}})(this._channels[i])}};SCSocket.prototype.watch=function(channelName,handler){this._channelEmitter.on(channelName,handler)};SCSocket.prototype.unwatch=function(channelName,handler){if(handler){this._channelEmitter.removeListener(channelName,handler)}else{this._channelEmitter.removeAllListeners(channelName)}};SCSocket.prototype.watchers=function(channelName){return this._channelEmitter.listeners(channelName)};module.exports=SCSocket}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./activitymanager":5,"./objectcreate":6,"./response":7,"./scchannel":8,emitter:10,querystring:3,ws:12}],10:[function(require,module,exports){var index=require("indexof");module.exports=Emitter;function Emitter(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in Emitter.prototype){obj[key]=Emitter.prototype[key]}return obj}Emitter.prototype.on=function(event,fn){this._callbacks=this._callbacks||{};(this._callbacks[event]=this._callbacks[event]||[]).push(fn);return this};Emitter.prototype.once=function(event,fn){var self=this;this._callbacks=this._callbacks||{};function on(){self.off(event,on);fn.apply(this,arguments)}fn._off=on;this.on(event,on);return this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=function(event,fn){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var callbacks=this._callbacks[event];if(!callbacks)return this;if(1==arguments.length){delete this._callbacks[event];return this}var i=index(callbacks,fn._off||fn);if(~i)callbacks.splice(i,1);return this};Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks[event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i){callbacks[i].apply(this,args)}}return this};Emitter.prototype.listeners=function(event){this._callbacks=this._callbacks||{};return this._callbacks[event]||[]};Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},{indexof:11}],11:[function(require,module,exports){var indexOf=[].indexOf;module.exports=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i){if(arr[i]===obj)return i}return-1}},{}],12:[function(require,module,exports){var global=function(){return this}();var WebSocket=global.WebSocket||global.MozWebSocket;module.exports=WebSocket?ws:null;function ws(uri,protocols,opts){var instance;if(protocols){instance=new WebSocket(uri,protocols)}else{instance=new WebSocket(uri)}return instance}if(WebSocket)ws.prototype=WebSocket.prototype},{}]},{},[4])(4)});